<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>EM Test JQuery</title>
    <link rel="stylesheet" href="nial.css">
    <script type="text/javascript" src="https://code.jquery.com/jquery-latest.js"></script>
</head>
<body>

   <div id="input">
    <h2>Nial Command Input</h2><br/>
    <span> Enter a nial command in the following input area then press the Execute button</span><br>
    <textarea id="gets_buffer" cols="80" rows="6"></textarea><br/>
    <button onclick="execnial()">Execute</button>
  </div>

  <hr/>
  <h2>Nial Output Buffer</h2><br/> 
  <div id="output" name="output" class="nialout"></div>


  <script>
    window.nial_input = '';
    
    var Module = {

	//wasmMemory: new WebAssembly.Memory({initial: 1024, maximum: 16384}),

	arguments: ["-i"],
	
	print: s => {
	    $("#output").append('<pre class="nialout">' + s +'</pre>');
	},

	printErr: s => {
	    $("#output").append('<pre class="nialerr">' + s +'</pre>');
	}   
    }
    

    function execnial() {
	var s = $("#gets_buffer").val();

	$("#gets_buffer").val('');
	
	const sa = s.split("\n");
	$("#output").append('<pre> </pre>');
	for (const elt of sa) {
	    $("#output").append('<pre class="nialin">' + elt + '</pre>');
	}
	
	var ns = s.replace(/\r/g, ' ');
	ns = ns.replace(/\n/g, ' ');
	
	window.nial_input = ns;	
    }

    
    $("#gets_buffer").keyup(ev => {
	if (ev.ctrlKey) {
	    if (ev.key == "a") {
		execnial();
	    }
	}
    });
    
    </script>
    


  <script type="text/javascript" src="nial.js"></script>

  
    
</body>
</html>
